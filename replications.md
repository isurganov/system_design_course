Распределенное хранение данных

Шардирование

Шардирование будет использоваться для распределения данных по нескольким узлам, чтобы обеспечить высокую производительность и масштабируемость. Данные будут распределены по следующим ключам:

	1.	Users: Шардирование по id.
	2.	Posts: Шардирование по user_id.
	3.	PostImages: Шардирование по post_id.
	4.	Comments: Шардирование по post_id.
	5.	Likes: Шардирование по post_id.
	6.	Follows: Шардирование по follower_id.
	7.	Messages: Шардирование по sender_id.

Репликация

Репликация будет использована для обеспечения отказоустойчивости и высокой доступности данных. Мы будем использовать многомастеровую репликацию (multi-master replication) для обеспечения высокой доступности и отказоустойчивости.

Расчет количества хостов

Необходимое количество дисков

Используя Intel Optane SSD DC P4800X для максимальной производительности:

	1.	Фотографии: 30 ТБ данных.
	•	Требуемое количество дисков: 30 ТБ / 1.5 ТБ ≈ 20 дисков.
	•	Требуемый IOPS: 100,000,000 IOPS.
	•	Один диск обеспечивает до 500,000 IOPS (запись), итого потребуется 200 дисков.
	2.	Прочие данные (1 ГБ + 2 ГБ + 20 ГБ + 20 ГБ + 50 ГБ + 10 ГБ ≈ 103 ГБ).
	•	Требуемое количество дисков: 103 ГБ / 1.5 ТБ ≈ 1 диск.

Итого: 200 дисков (для IOPS) + 1 диск (для объема данных) = 201 диск.

Расчет количества хостов

	1.	Количество хостов:
	•	Хостов = 201 дисков / 10 дисков на хост ≈ 21 хост.
	•	Хостов с репликацией (3-кратная репликация) = 21 хост * 3 ≈ 63 хоста.

Итоговое распределение данных

Для обеспечения надежной и масштабируемой системы хранения данных для вашей социальной сети путешественников, мы будем использовать 63 хоста с 3-кратной репликацией, что обеспечит высокую доступность и отказоустойчивость системыю